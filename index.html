<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revver In-App Feedback Dashboard 2025</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --revver-purple: #6B46C1;
            --revver-purple-dark: #553C9A;
            --revver-purple-light: #9F7AEA;
            --revver-teal: #319795;
            --revver-teal-dark: #2C7A7B;
            --revver-teal-light: #4FD1C5;
            --bg-dark: #1A1F2E;
            --bg-card: #242938;
            --bg-card-hover: #2D3348;
            --text-primary: #F7FAFC;
            --text-secondary: #A0AEC0;
            --text-muted: #718096;
            --border-color: #3D4663;
            --positive: #48BB78;
            --negative: #F56565;
            --neutral: #ECC94B;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #0F1219 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, var(--revver-purple) 0%, var(--revver-teal) 100%);
            padding: 24px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 20px rgba(107, 70, 193, 0.3);
        }
        
        .logo-section { display: flex; align-items: center; gap: 16px; }
        
        .logo {
            width: 48px; height: 48px;
            background: white; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 20px;
            color: var(--revver-purple);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .header-title h1 { font-size: 24px; font-weight: 700; letter-spacing: -0.5px; }
        .header-title p { font-size: 14px; opacity: 0.9; }
        
        .month-selector { display: flex; align-items: center; gap: 12px; }
        .month-selector label { font-weight: 500; font-size: 14px; }
        .month-selector select {
            background: rgba(255,255,255,0.15);
            border: 1px solid rgba(255,255,255,0.3);
            color: white; padding: 10px 16px;
            border-radius: 8px; font-size: 14px;
            font-weight: 500; cursor: pointer; min-width: 160px;
        }
        .month-selector select option { background: var(--bg-card); color: var(--text-primary); }
        
        .container { max-width: 1600px; margin: 0 auto; padding: 32px; }
        
        .stats-row {
            display: grid; grid-template-columns: repeat(4, 1fr);
            gap: 20px; margin-bottom: 32px;
        }
        
        .stat-card {
            background: var(--bg-card); border-radius: 16px;
            padding: 24px; border: 1px solid var(--border-color);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.3); }
        .stat-label { font-size: 13px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
        .stat-value {
            font-size: 36px; font-weight: 700;
            background: linear-gradient(135deg, var(--revver-teal-light), var(--revver-purple-light));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }
        .stat-detail { font-size: 12px; color: var(--text-muted); margin-top: 4px; }
        
        .chart-card {
            background: var(--bg-card); border-radius: 16px;
            padding: 24px; border: 1px solid var(--border-color);
            margin-bottom: 24px;
        }
        
        .chart-title {
            font-size: 18px; font-weight: 600; margin-bottom: 20px;
            color: var(--text-primary); display: flex; align-items: center; gap: 10px;
        }
        .chart-title-icon {
            width: 32px; height: 32px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; font-size: 16px;
        }
        .icon-purple { background: rgba(107, 70, 193, 0.2); }
        .icon-teal { background: rgba(49, 151, 149, 0.2); }
        .icon-green { background: rgba(72, 187, 120, 0.2); }
        .icon-orange { background: rgba(237, 137, 54, 0.2); }
        
        .chart-container { position: relative; height: 400px; }
        .chart-container-tall { position: relative; height: 500px; }
        .chart-container-small { position: relative; height: 280px; }
        
        .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px; }
        .three-column { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 24px; margin-bottom: 32px; }
        .charts-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; margin-bottom: 32px; }
        
        /* Category breakdown table */
        .breakdown-table {
            width: 100%; border-collapse: collapse;
            font-size: 13px;
        }
        .breakdown-table th {
            text-align: left; padding: 12px 8px;
            border-bottom: 2px solid var(--border-color);
            color: var(--text-secondary); font-weight: 600;
            text-transform: uppercase; font-size: 11px; letter-spacing: 0.5px;
        }
        .breakdown-table td {
            padding: 12px 8px; border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }
        .breakdown-table tr:hover { background: var(--bg-card-hover); }
        .breakdown-table .cat-name { font-weight: 500; color: var(--text-primary); max-width: 180px; }
        .breakdown-table .num { text-align: center; font-variant-numeric: tabular-nums; }
        .breakdown-table .pct { font-weight: 600; }
        .pct-positive { color: var(--positive); }
        .pct-negative { color: var(--negative); }
        
        .user-bar {
            display: flex; height: 20px; border-radius: 4px; overflow: hidden;
            background: var(--border-color);
        }
        .user-bar-guest {
            background: linear-gradient(90deg, var(--revver-teal), var(--revver-teal-light));
            transition: width 0.3s;
        }
        .user-bar-regular {
            background: linear-gradient(90deg, var(--revver-purple), var(--revver-purple-light));
            transition: width 0.3s;
        }
        
        .bar-legend {
            display: flex; gap: 20px; margin-top: 16px; justify-content: center;
        }
        .bar-legend-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--text-secondary); }
        .bar-legend-dot { width: 12px; height: 12px; border-radius: 3px; }
        .dot-guest { background: var(--revver-teal); }
        .dot-regular { background: var(--revver-purple); }
        .dot-positive { background: var(--positive); }
        .dot-negative { background: var(--negative); }
        .dot-neutral { background: var(--neutral); }
        
        /* Comparison cards */
        .comparison-section { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px; }
        .comparison-card { background: var(--bg-card); border-radius: 16px; padding: 24px; border: 1px solid var(--border-color); }
        .comparison-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
        .user-badge { padding: 6px 14px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .badge-guest { background: linear-gradient(135deg, var(--revver-teal), var(--revver-teal-dark)); }
        .badge-regular { background: linear-gradient(135deg, var(--revver-purple), var(--revver-purple-dark)); }
        
        .category-list { display: flex; flex-direction: column; gap: 12px; }
        .category-item { display: flex; align-items: center; gap: 12px; }
        .category-rank { width: 28px; height: 28px; border-radius: 50%; background: var(--border-color); display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; flex-shrink: 0; }
        .category-bar-container { flex: 1; display: flex; flex-direction: column; gap: 4px; }
        .category-name { font-size: 13px; color: var(--text-secondary); }
        .category-bar { height: 8px; background: var(--border-color); border-radius: 4px; overflow: hidden; }
        .category-bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
        .fill-guest { background: linear-gradient(90deg, var(--revver-teal), var(--revver-teal-light)); }
        .fill-regular { background: linear-gradient(90deg, var(--revver-purple), var(--revver-purple-light)); }
        .category-count { font-size: 14px; font-weight: 600; color: var(--text-primary); min-width: 50px; text-align: right; }
        
        /* Domain section */
        .domain-section { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        .domain-card { background: var(--bg-card); border-radius: 16px; padding: 24px; border: 1px solid var(--border-color); }
        .domain-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
        .domain-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .icon-positive { background: rgba(72, 187, 120, 0.15); }
        .icon-negative { background: rgba(245, 101, 101, 0.15); }
        .domain-list { display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto; }
        .domain-item { display: flex; align-items: center; padding: 12px; background: var(--bg-card-hover); border-radius: 10px; gap: 12px; }
        .domain-name { flex: 1; font-size: 13px; font-weight: 500; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .domain-rate { font-size: 14px; font-weight: 700; min-width: 60px; text-align: right; }
        .rate-positive { color: var(--positive); }
        .rate-negative { color: var(--negative); }
        .domain-count { font-size: 11px; color: var(--text-muted); min-width: 60px; text-align: right; }
        
        /* Feature ranking styles */
        .feature-ranking { display: flex; flex-direction: column; gap: 16px; }
        .feature-item {
            display: flex; align-items: center; gap: 16px;
            padding: 16px; background: var(--bg-card-hover);
            border-radius: 12px; transition: transform 0.2s;
        }
        .feature-item:hover { transform: translateX(4px); }
        .feature-rank {
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; font-weight: 700; flex-shrink: 0;
        }
        .rank-positive { background: linear-gradient(135deg, var(--positive), #38A169); color: white; }
        .rank-negative { background: linear-gradient(135deg, var(--negative), #C53030); color: white; }
        .feature-info { flex: 1; }
        .feature-name { font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
        .feature-bar { height: 6px; background: var(--border-color); border-radius: 3px; overflow: hidden; margin-bottom: 4px; }
        .feature-bar-fill-positive { height: 100%; background: linear-gradient(90deg, var(--positive), #68D391); border-radius: 3px; }
        .feature-bar-fill-negative { height: 100%; background: linear-gradient(90deg, var(--negative), #FC8181); border-radius: 3px; }
        .feature-stats { font-size: 11px; color: var(--text-muted); }
        .feature-count { font-size: 24px; font-weight: 700; min-width: 60px; text-align: right; }
        .count-positive { color: var(--positive); }
        .count-negative { color: var(--negative); }
        
        /* Yearly badge for sections that don't respond to month selection */
        .yearly-badge {
            font-size: 11px;
            font-weight: 500;
            color: var(--revver-teal-light);
            background: rgba(49, 151, 149, 0.15);
            padding: 4px 10px;
            border-radius: 12px;
            margin-left: auto;
        }
        
        /* Three-source ranking grid */
        .ranking-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
        }
        .ranking-column {
            background: var(--bg-card-hover);
            border-radius: 12px;
            padding: 20px;
        }
        .ranking-column-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }
        .ranking-column-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        .ranking-column-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .ranking-column-subtitle {
            font-size: 11px;
            color: var(--text-muted);
        }
        .ranking-list { display: flex; flex-direction: column; gap: 8px; }
        .ranking-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            background: var(--bg-card);
            border-radius: 8px;
            font-size: 12px;
        }
        .ranking-position {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            flex-shrink: 0;
        }
        .pos-1 { background: linear-gradient(135deg, #F6E05E, #D69E2E); color: #744210; }
        .pos-2 { background: linear-gradient(135deg, #CBD5E0, #A0AEC0); color: #2D3748; }
        .pos-3 { background: linear-gradient(135deg, #ED8936, #C05621); color: white; }
        .pos-other { background: var(--border-color); color: var(--text-secondary); }
        .ranking-name { flex: 1; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .ranking-count { font-weight: 600; color: var(--text-secondary); }
        
        /* Insight lists for commonalities and gaps */
        .insight-list { display: flex; flex-direction: column; gap: 12px; }
        .insight-item {
            background: var(--bg-card-hover);
            border-radius: 10px;
            padding: 14px 16px;
        }
        .insight-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .insight-icon {
            font-size: 18px;
        }
        .insight-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .insight-bars {
            display: flex;
            gap: 8px;
        }
        .insight-bar-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .insight-bar-label {
            font-size: 10px;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
        }
        .insight-bar {
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
        }
        .insight-bar-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        .fill-inapp { background: linear-gradient(90deg, #6B46C1, #9F7AEA); }
        .fill-tech { background: linear-gradient(90deg, #ED8936, #F6AD55); }
        .fill-voc { background: linear-gradient(90deg, #9F7AEA, #D6BCFA); }
        .insight-note {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
            font-style: italic;
        }
        
        /* Heatmap styles */
        .heatmap-container {
            overflow-x: auto;
        }
        .heatmap-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }
        .heatmap-table th {
            padding: 10px 8px;
            text-align: left;
            color: var(--text-secondary);
            font-weight: 600;
            border-bottom: 2px solid var(--border-color);
            white-space: nowrap;
        }
        .heatmap-table th.source-header {
            text-align: center;
            min-width: 100px;
        }
        .heatmap-table td {
            padding: 10px 8px;
            border-bottom: 1px solid var(--border-color);
        }
        .heatmap-table td.cat-name {
            color: var(--text-primary);
            font-weight: 500;
            max-width: 200px;
        }
        .heatmap-cell {
            text-align: center;
            font-weight: 600;
            border-radius: 4px;
            color: white;
        }
        .heatmap-table tr:hover {
            background: var(--bg-card-hover);
        }
        
        /* Period indicator that shows current selection */
        .period-indicator {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, var(--revver-purple), var(--revver-teal));
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 12px;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-4px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Tooltip styling for enhanced trend chart */
        .trend-tooltip {
            background: var(--bg-card) !important;
            border: 1px solid var(--border-color) !important;
            border-radius: 12px !important;
            padding: 16px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4) !important;
        }
        
        .section-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-color), transparent);
            margin: 40px 0;
        }
        
        .section-header {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 24px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .section-header span {
            font-size: 14px;
            font-weight: 400;
            color: var(--text-muted);
        }
        
        .footer {
            text-align: center; padding: 32px;
            color: var(--text-muted); font-size: 13px;
        }
        .footer a { color: var(--revver-teal-light); text-decoration: none; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); border-radius: 3px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }
        
        @media (max-width: 1200px) {
            .stats-row { grid-template-columns: repeat(2, 1fr); }
            .charts-grid, .two-column, .comparison-section, .domain-section { grid-template-columns: 1fr; }
            .ranking-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .header { flex-direction: column; gap: 20px; padding: 20px; }
            .container { padding: 16px; }
            .stats-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo-section">
            <div class="logo">R</div>
            <div class="header-title">
                <h1>In-App Feedback Dashboard <span id="periodIndicator" class="period-indicator">Full Year 2025</span></h1>
                <p>2025 Customer Feedback Analysis</p>
            </div>
        </div>
        <div class="month-selector">
            <label for="monthSelect">View Period:</label>
            <select id="monthSelect">
                <option value="yearly">üìä Full Year 2025</option>
                <option value="2025-01">January 2025</option>
                <option value="2025-02">February 2025</option>
                <option value="2025-03">March 2025</option>
                <option value="2025-04">April 2025</option>
                <option value="2025-05">May 2025</option>
                <option value="2025-06">June 2025</option>
                <option value="2025-07">July 2025</option>
                <option value="2025-08">August 2025</option>
                <option value="2025-09">September 2025</option>
                <option value="2025-10">October 2025</option>
                <option value="2025-11">November 2025</option>
            </select>
        </div>
    </header>
    
    <main class="container">
        <!-- NEW: Most Liked / Most Complained Section -->
        <section class="two-column" style="margin-bottom: 32px;">
            <div class="chart-card" style="margin-bottom: 0; border-left: 4px solid var(--positive);">
                <div class="chart-title">
                    <span class="chart-title-icon icon-positive" style="background: rgba(72, 187, 120, 0.2);">üëç</span>
                    Most Liked Features
                    <span class="yearly-badge">üìÖ Yearly</span>
                </div>
                <div class="feature-ranking" id="mostLikedFeatures"></div>
            </div>
            <div class="chart-card" style="margin-bottom: 0; border-left: 4px solid var(--negative);">
                <div class="chart-title">
                    <span class="chart-title-icon icon-negative" style="background: rgba(245, 101, 101, 0.2);">üëé</span>
                    Most Complained About Features
                    <span class="yearly-badge">üìÖ Yearly</span>
                </div>
                <div class="feature-ranking" id="mostComplainedFeatures"></div>
            </div>
        </section>
        
        <!-- Stats Row - RESPONDS TO PERIOD SELECTION -->
        <div class="section-header" style="margin-bottom: 16px;">
            <span style="font-size: 14px; color: var(--text-muted);">üìä These sections update based on period selection above ‚Üó</span>
        </div>
        <section class="stats-row">
            <div class="stat-card">
                <div class="stat-label">Total Feedback</div>
                <div class="stat-value" id="totalFeedback">2,440</div>
                <div class="stat-detail" id="feedbackDetail">All categories combined</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Sentiment Score</div>
                <div class="stat-value" id="sentimentScore">25%</div>
                <div class="stat-detail" id="sentimentDetail">Positive feedback rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Guest Users</div>
                <div class="stat-value" id="guestPercent">29%</div>
                <div class="stat-detail" id="guestDetail">717 of 2,440 responses</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Browser vs Desktop</div>
                <div class="stat-value" id="browserPercent">69%</div>
                <div class="stat-detail" id="browserDetail">Browser users</div>
            </div>
        </section>
        
        <!-- NEW: Category by Sentiment Stacked Bar Chart -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon icon-purple">üìä</span>
                Feedback by Category & Sentiment
                <span class="yearly-badge">üìÖ Yearly</span>
            </div>
            <div class="chart-container-tall">
                <canvas id="categorySentimentChart"></canvas>
            </div>
            <div class="bar-legend">
                <div class="bar-legend-item"><div class="bar-legend-dot dot-positive"></div> Positive</div>
                <div class="bar-legend-item"><div class="bar-legend-dot dot-negative"></div> Negative</div>
                <div class="bar-legend-item"><div class="bar-legend-dot dot-neutral"></div> Neutral</div>
            </div>
        </section>
        
        <!-- NEW: Category Breakdown Table with Guest/Regular by Sentiment -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon icon-teal">üë•</span>
                Guest vs Regular User Breakdown by Category & Sentiment
                <span class="yearly-badge">üìÖ Yearly</span>
            </div>
            <div style="overflow-x: auto;">
                <table class="breakdown-table" id="breakdownTable">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th class="num">Positive</th>
                            <th style="min-width: 140px;">Positive: Guest vs Regular</th>
                            <th class="num">Negative</th>
                            <th style="min-width: 140px;">Negative: Guest vs Regular</th>
                        </tr>
                    </thead>
                    <tbody id="breakdownTableBody"></tbody>
                </table>
            </div>
            <div class="bar-legend" style="margin-top: 20px;">
                <div class="bar-legend-item"><div class="bar-legend-dot dot-guest"></div> Guest Users</div>
                <div class="bar-legend-item"><div class="bar-legend-dot dot-regular"></div> Regular Users</div>
            </div>
        </section>
        
        <div class="section-divider"></div>
        
        <!-- NEW: Enhanced Sentiment Trend with Hover Details -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon icon-green">üìà</span>
                Sentiment Trend Over Time <span style="font-size: 13px; color: var(--text-muted); font-weight: 400; margin-left: 12px;">Hover for top categories by user type</span>
            </div>
            <div class="chart-container">
                <canvas id="enhancedTrendChart"></canvas>
            </div>
        </section>
        
        <div class="section-divider"></div>
        
        <!-- NEW: VoC Section Header -->
        <div class="section-header">
            üé§ Voice of Customer (VoC) Analysis
            <span>Cross-functional meeting themes, Jan-Oct 2025</span>
        </div>
        
        <!-- NEW: Three-Source Ranking Comparison -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon" style="background: rgba(237, 137, 54, 0.2);">üèÜ</span>
                Category Rankings Across All Sources
                <span class="yearly-badge">üìÖ 2025</span>
            </div>
            <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 20px;">
                Compare how categories rank by volume across In-App Feedback, Tech Services, and VoC Meetings
            </p>
            <div id="threeSourceRanking" class="ranking-grid"></div>
        </section>
        
        <!-- NEW: Commonalities & Gaps Analysis -->
        <section class="two-column">
            <div class="chart-card" style="margin-bottom: 0; border-left: 4px solid var(--positive);">
                <div class="chart-title">
                    <span class="chart-title-icon" style="background: rgba(72, 187, 120, 0.2);">‚úÖ</span>
                    Validated Pain Points
                    <span class="yearly-badge">üìÖ 2025</span>
                </div>
                <p style="color: var(--text-muted); font-size: 12px; margin-bottom: 16px;">
                    Categories that rank high across multiple sources ‚Äî confirmed problems worth prioritizing
                </p>
                <div id="commonalitiesList" class="insight-list"></div>
            </div>
            <div class="chart-card" style="margin-bottom: 0; border-left: 4px solid var(--negative);">
                <div class="chart-title">
                    <span class="chart-title-icon" style="background: rgba(245, 101, 101, 0.2);">üî¥</span>
                    Source-Specific Blind Spots
                    <span class="yearly-badge">üìÖ 2025</span>
                </div>
                <p style="color: var(--text-muted); font-size: 12px; margin-bottom: 16px;">
                    Categories with major disparity ‚Äî you'd miss these looking at only one source
                </p>
                <div id="gapsList" class="insight-list"></div>
            </div>
        </section>
        
        <!-- NEW: Source Coverage Heatmap -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon" style="background: rgba(49, 151, 149, 0.2);">üìä</span>
                Category Coverage by Source (% of each source's total)
                <span class="yearly-badge">üìÖ 2025</span>
            </div>
            <p style="color: var(--text-muted); font-size: 12px; margin-bottom: 16px;">
                Heatmap showing what percentage of each source's feedback each category represents. Darker = higher concentration.
            </p>
            <div id="coverageHeatmap" class="heatmap-container"></div>
            <div class="bar-legend" style="margin-top: 20px;">
                <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #1A1F2E;"></div> 0%</div>
                <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #553C9A;"></div> 10%</div>
                <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #805AD5;"></div> 20%</div>
                <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #B794F4;"></div> 40%+</div>
            </div>
        </section>
        
        <!-- NEW: VoC vs In-App Comparison -->
        <section class="two-column">
            <div class="chart-card" style="margin-bottom: 0;">
                <div class="chart-title">
                    <span class="chart-title-icon icon-purple">üìä</span>
                    VoC vs In-App: Top Themes
                    <span class="yearly-badge">üìÖ 2025</span>
                </div>
                <div class="chart-container">
                    <canvas id="vocVsInAppChart"></canvas>
                </div>
                <div class="bar-legend" style="margin-top: 16px;">
                    <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #9F7AEA;"></div> VoC Meetings (177 total)</div>
                    <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #6B46C1;"></div> In-App Feedback (1,232 total)</div>
                </div>
            </div>
            <div class="chart-card" style="margin-bottom: 0;">
                <div class="chart-title">
                    <span class="chart-title-icon icon-teal">üìà</span>
                    VoC Monthly Volume Trend
                    <span class="yearly-badge">üìÖ Jan-Oct</span>
                </div>
                <div class="chart-container">
                    <canvas id="vocMonthlyChart"></canvas>
                </div>
            </div>
        </section>
        
        <!-- NEW: VoC Top Categories by Month Heatmap-style -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon icon-green">üóìÔ∏è</span>
                VoC Category Trends by Month
                <span class="yearly-badge">üìÖ Jan-Oct</span>
            </div>
            <div class="chart-container-tall">
                <canvas id="vocHeatmapChart"></canvas>
            </div>
        </section>
        
        <div class="section-divider"></div>
        
        <!-- NEW: In-App vs Tech Services Comparison -->
        <section class="chart-card">
            <div class="chart-title">
                <span class="chart-title-icon icon-orange">üîÑ</span>
                In-App Feedback vs Tech Services (Regular Users)
                <span class="yearly-badge">üìÖ Jun-Oct</span>
            </div>
            <div class="chart-container-tall">
                <canvas id="sourceComparisonChart"></canvas>
            </div>
            <div class="bar-legend" style="margin-top: 20px;">
                <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #6B46C1;"></div> In-App Feedback (199 total)</div>
                <div class="bar-legend-item"><div class="bar-legend-dot" style="background: #ED8936;"></div> Tech Services (1,197 total)</div>
            </div>
        </section>
        
        <div class="section-divider"></div>
        
        <!-- Original Charts Row -->
        <section class="charts-grid">
            <div class="chart-card" style="margin-bottom: 0;">
                <div class="chart-title">
                    <span class="chart-title-icon icon-purple">üìÇ</span>
                    Feedback by Functional Category
                </div>
                <div class="chart-container">
                    <canvas id="categoryChart"></canvas>
                </div>
            </div>
            <div class="chart-card" style="margin-bottom: 0;">
                <div class="chart-title">
                    <span class="chart-title-icon icon-teal">üòä</span>
                    Sentiment Distribution
                </div>
                <div class="chart-container-small">
                    <canvas id="sentimentChart"></canvas>
                </div>
            </div>
        </section>
        
        <!-- User Type and System Charts -->
        <section class="two-column">
            <div class="chart-card" style="margin-bottom: 0;">
                <div class="chart-title">
                    <span class="chart-title-icon icon-green">üë•</span>
                    User Type Distribution
                </div>
                <div class="chart-container-small">
                    <canvas id="userTypeChart"></canvas>
                </div>
            </div>
            <div class="chart-card" style="margin-bottom: 0;">
                <div class="chart-title">
                    <span class="chart-title-icon icon-orange">üíª</span>
                    System Type Distribution
                </div>
                <div class="chart-container-small">
                    <canvas id="systemChart"></canvas>
                </div>
            </div>
        </section>
        
        <!-- Guest vs Regular Comparison -->
        <section class="comparison-section">
            <div class="comparison-card">
                <div class="comparison-header">
                    <span class="user-badge badge-guest">üë§ Guest Users</span>
                    <span style="color: var(--text-muted); font-size: 14px;">Top 5 Categories</span>
                </div>
                <div class="category-list" id="guestCategories"></div>
            </div>
            <div class="comparison-card">
                <div class="comparison-header">
                    <span class="user-badge badge-regular">üëî Regular Users</span>
                    <span style="color: var(--text-muted); font-size: 14px;">Top 5 Categories</span>
                </div>
                <div class="category-list" id="regularCategories"></div>
            </div>
        </section>
        
        <!-- Domain Sentiment Analysis -->
        <section class="domain-section">
            <div class="domain-card">
                <div class="domain-header">
                    <span class="domain-icon icon-positive">‚úì</span>
                    <div>
                        <div class="chart-title" style="margin-bottom: 0;">Most Positive Domains</div>
                        <div style="font-size: 12px; color: var(--text-muted);">Minimum 5 feedback entries</div>
                    </div>
                </div>
                <div class="domain-list" id="positiveDomains"></div>
            </div>
            <div class="domain-card">
                <div class="domain-header">
                    <span class="domain-icon icon-negative">‚úó</span>
                    <div>
                        <div class="chart-title" style="margin-bottom: 0;">Most Negative Domains</div>
                        <div style="font-size: 12px; color: var(--text-muted);">Minimum 5 feedback entries</div>
                    </div>
                </div>
                <div class="domain-list" id="negativeDomains"></div>
            </div>
        </section>
    </main>
    
    <footer class="footer">
        <p>Revver In-App Feedback Dashboard ‚Ä¢ Generated December 2025 ‚Ä¢ Data from Jan-Nov 2025</p>
        <p style="margin-top: 8px;">Built for UX Research Team</p>
    </footer>

    <script>
        // ============= DATA =============
        const dashboardData = {
            months: ["2025-01","2025-02","2025-03","2025-04","2025-05","2025-06","2025-07","2025-08","2025-09","2025-10","2025-11"],
            monthLabels: ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov"],
            monthly: {
                "2025-01": {
                    categories: {"Sentiment Only":132,"Dislike New Experience":35,"Performance & Speed":29,"File Management":20,"Login & Access":19,"Document Functions":19,"System Stability":17,"User Interface & Navigation":17,"Collaboration":10,"Visual & Accessibility":5,"Search":5},
                    sentiment: {"Negative":166,"Positive":76,"Neutral":69},
                    userType: {"Regular":236,"Guest":75},
                    system: {"Browser":180,"Desktop":131},
                    guestTop5: {"Sentiment Only":44,"Collaboration":7,"User Interface & Navigation":7,"File Management":6,"Login & Access":3},
                    regularTop5: {"Sentiment Only":88,"Dislike New Experience":34,"Performance & Speed":28,"Document Functions":17,"Login & Access":16}
                },
                "2025-02": {
                    categories: {"Sentiment Only":83,"Dislike New Experience":14,"Login & Access":14,"Performance & Speed":13,"System Stability":10,"File Management":8,"Document Functions":8,"Search":7,"Visual & Accessibility":6,"User Interface & Navigation":4},
                    sentiment: {"Negative":79,"Neutral":65,"Positive":31},
                    userType: {"Regular":174,"Guest":1},
                    system: {"Browser":85,"Desktop":90},
                    guestTop5: {"Document Functions":1},
                    regularTop5: {"Sentiment Only":83,"Dislike New Experience":14,"Login & Access":14,"Performance & Speed":13,"System Stability":10}
                },
                "2025-03": {
                    categories: {"Sentiment Only":180,"File Management":48,"Dislike New Experience":32,"User Interface & Navigation":27,"Document Functions":18,"Performance & Speed":13,"Login & Access":10,"Collaboration":7,"Visual & Accessibility":5,"Search":5},
                    sentiment: {"Neutral":75,"Positive":118,"Negative":161},
                    userType: {"Guest":184,"Regular":170},
                    system: {"Browser":295,"Desktop":59},
                    guestTop5: {"Sentiment Only":107,"File Management":35,"User Interface & Navigation":17,"Login & Access":6,"Document Functions":6},
                    regularTop5: {"Sentiment Only":73,"Dislike New Experience":32,"File Management":13,"Document Functions":12,"User Interface & Navigation":10}
                },
                "2025-04": {
                    categories: {"Sentiment Only":157,"User Interface & Navigation":25,"File Management":17,"Dislike New Experience":9,"Performance & Speed":9,"Login & Access":8,"Document Functions":8,"Collaboration":7,"System Stability":6,"Visual & Accessibility":5},
                    sentiment: {"Positive":83,"Negative":95,"Neutral":79},
                    userType: {"Guest":121,"Regular":136},
                    system: {"Browser":215,"Desktop":42},
                    guestTop5: {"Sentiment Only":83,"User Interface & Navigation":13,"File Management":8,"Collaboration":6,"Login & Access":5},
                    regularTop5: {"Sentiment Only":74,"User Interface & Navigation":12,"File Management":9,"Dislike New Experience":8,"Document Functions":8}
                },
                "2025-05": {
                    categories: {"Sentiment Only":170,"Dislike New Experience":34,"System Stability":14,"Document Functions":12,"Visual & Accessibility":11,"File Management":10,"User Interface & Navigation":10,"Performance & Speed":7,"Search":5},
                    sentiment: {"Negative":105,"Neutral":128,"Positive":53},
                    userType: {"Regular":234,"Guest":52},
                    system: {"Browser":165,"Desktop":121},
                    guestTop5: {"Sentiment Only":34,"Visual & Accessibility":6,"File Management":4,"User Interface & Navigation":3,"Dislike New Experience":2},
                    regularTop5: {"Sentiment Only":136,"Dislike New Experience":32,"System Stability":14,"Document Functions":11,"User Interface & Navigation":7}
                },
                "2025-06": {
                    categories: {"Sentiment Only":98,"Dislike New Experience":34,"Document Functions":13,"User Interface & Navigation":10,"Visual & Accessibility":8,"File Management":6,"Search":5,"Performance & Speed":5,"System Stability":4,"Login & Access":4},
                    sentiment: {"Neutral":58,"Positive":38,"Negative":94},
                    userType: {"Regular":150,"Guest":40},
                    system: {"Browser":135,"Desktop":55},
                    guestTop5: {"Sentiment Only":31,"User Interface & Navigation":4,"File Management":2,"Login & Access":1,"Mobile and Responsiveness":1},
                    regularTop5: {"Sentiment Only":67,"Dislike New Experience":34,"Document Functions":12,"Visual & Accessibility":8,"User Interface & Navigation":6}
                },
                "2025-07": {
                    categories: {"Sentiment Only":61,"Dislike New Experience":23,"System Stability":11,"Document Functions":10,"Login & Access":10,"User Interface & Navigation":8,"Visual & Accessibility":7,"File Management":6,"Performance & Speed":6,"Search":5},
                    sentiment: {"Negative":82,"Positive":33,"Neutral":48},
                    userType: {"Guest":36,"Regular":127},
                    system: {"Browser":118,"Desktop":45},
                    guestTop5: {"Sentiment Only":22,"User Interface & Navigation":2,"Collaboration":2,"Mobile and Responsiveness":2,"Login & Access":2},
                    regularTop5: {"Sentiment Only":39,"Dislike New Experience":22,"System Stability":11,"Document Functions":9,"Login & Access":8}
                },
                "2025-08": {
                    categories: {"Sentiment Only":91,"Performance & Speed":13,"File Management":12,"Document Functions":11,"Login & Access":6,"User Interface & Navigation":5,"Automations and Workflows":5,"System Stability":4},
                    sentiment: {"Negative":63,"Positive":39,"Neutral":53},
                    userType: {"Regular":104,"Guest":51},
                    system: {"Desktop":45,"Browser":110},
                    guestTop5: {"Sentiment Only":38,"User Interface & Navigation":4,"File Management":2,"Login & Access":2,"Performance & Speed":2},
                    regularTop5: {"Sentiment Only":53,"Performance & Speed":11,"Document Functions":10,"File Management":10,"Automations and Workflows":5}
                },
                "2025-09": {
                    categories: {"Sentiment Only":91,"File Management":13,"User Interface & Navigation":9,"Document Functions":7,"Login & Access":5,"Performance & Speed":5,"System Stability":4,"Collaboration":4,"Dislike New Experience":3},
                    sentiment: {"Negative":54,"Positive":40,"Neutral":51},
                    userType: {"Guest":50,"Regular":95},
                    system: {"Browser":103,"Desktop":42},
                    guestTop5: {"Sentiment Only":42,"Collaboration":3,"User Interface & Navigation":2,"Document Functions":1,"File Management":1},
                    regularTop5: {"Sentiment Only":49,"File Management":12,"User Interface & Navigation":7,"Document Functions":6,"Login & Access":5}
                },
                "2025-10": {
                    categories: {"Sentiment Only":88,"Document Functions":41,"User Interface & Navigation":28,"Metadata and Smart Extract":17,"File Management":14,"Login & Access":14,"Dislike New Experience":12,"Performance & Speed":8,"System Stability":7,"Visual & Accessibility":6},
                    sentiment: {"Negative":166,"Neutral":26,"Positive":57},
                    userType: {"Regular":187,"Guest":62},
                    system: {"Desktop":83,"Browser":166},
                    guestTop5: {"Sentiment Only":35,"User Interface & Navigation":9,"File Management":4,"Collaboration":3,"Metadata and Smart Extract":3},
                    regularTop5: {"Sentiment Only":53,"Document Functions":39,"User Interface & Navigation":19,"Metadata and Smart Extract":14,"Login & Access":12}
                },
                "2025-11": {
                    categories: {"Sentiment Only":57,"Document Functions":21,"User Interface & Navigation":20,"Collaboration":15,"Dislike New Experience":9,"Performance & Speed":7,"Login & Access":7,"Metadata and Smart Extract":4,"System Stability":4},
                    sentiment: {"Positive":42,"Negative":96,"Neutral":17},
                    userType: {"Guest":45,"Regular":110},
                    system: {"Browser":108,"Desktop":47},
                    guestTop5: {"Sentiment Only":26,"Collaboration":7,"User Interface & Navigation":5,"Metadata and Smart Extract":3,"Performance & Speed":2},
                    regularTop5: {"Sentiment Only":31,"Document Functions":19,"User Interface & Navigation":15,"Dislike New Experience":9,"Collaboration":8}
                }
            },
            yearly: {
                categories: {"Sentiment Only":1208,"Dislike New Experience":206,"Document Functions":168,"User Interface & Navigation":163,"File Management":156,"Performance & Speed":115,"Login & Access":100,"System Stability":84,"Visual & Accessibility":60,"Collaboration":56,"Search":40,"Metadata and Smart Extract":24,"Automations and Workflows":20,"Email, Notifications and Alerts":12,"Integrations":10,"Mobile and Responsiveness":10,"Account Management and Settings":6},
                sentiment: {"Negative":1161,"Positive":610,"Neutral":669},
                userType: {"Regular":1723,"Guest":717},
                system: {"Browser":1680,"Desktop":760},
                guestTop5: {"Sentiment Only":462,"User Interface & Navigation":66,"File Management":63,"Collaboration":32,"Login & Access":21},
                regularTop5: {"Sentiment Only":746,"Dislike New Experience":199,"Document Functions":150,"Performance & Speed":101,"User Interface & Navigation":97}
            },
            // NEW: Category by sentiment breakdown
            categorySentiment: {
                "Sentiment Only": {"Positive":470,"Negative":335,"Neutral":403,"Total":1208},
                "Dislike New Experience": {"Positive":8,"Negative":156,"Neutral":42,"Total":206},
                "Document Functions": {"Positive":11,"Negative":125,"Neutral":32,"Total":168},
                "User Interface & Navigation": {"Positive":41,"Negative":101,"Neutral":21,"Total":163},
                "File Management": {"Positive":30,"Negative":91,"Neutral":35,"Total":156},
                "Performance & Speed": {"Positive":8,"Negative":68,"Neutral":39,"Total":115},
                "Login & Access": {"Positive":7,"Negative":85,"Neutral":8,"Total":100},
                "System Stability": {"Positive":5,"Negative":49,"Neutral":30,"Total":84},
                "Visual & Accessibility": {"Positive":5,"Negative":36,"Neutral":19,"Total":60},
                "Collaboration": {"Positive":10,"Negative":36,"Neutral":10,"Total":56},
                "Search": {"Positive":9,"Negative":16,"Neutral":15,"Total":40},
                "Metadata and Smart Extract": {"Positive":2,"Negative":22,"Neutral":0,"Total":24},
                "Automations and Workflows": {"Positive":1,"Negative":14,"Neutral":5,"Total":20},
                "Email, Notifications and Alerts": {"Positive":0,"Negative":5,"Neutral":7,"Total":12},
                "Integrations": {"Positive":1,"Negative":9,"Neutral":0,"Total":10},
                "Mobile and Responsiveness": {"Positive":1,"Negative":8,"Neutral":1,"Total":10}
            },
            // NEW: Category by sentiment by user type
            categorySentimentUserType: {
                "Sentiment Only": {"Positive":{"Guest":257,"Regular":213,"GuestPct":54.7,"RegularPct":45.3},"Negative":{"Guest":96,"Regular":239,"GuestPct":28.7,"RegularPct":71.3}},
                "Dislike New Experience": {"Positive":{"Guest":0,"Regular":8,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":6,"Regular":150,"GuestPct":3.8,"RegularPct":96.2}},
                "Document Functions": {"Positive":{"Guest":1,"Regular":10,"GuestPct":9.1,"RegularPct":90.9},"Negative":{"Guest":14,"Regular":111,"GuestPct":11.2,"RegularPct":88.8}},
                "User Interface & Navigation": {"Positive":{"Guest":14,"Regular":27,"GuestPct":34.1,"RegularPct":65.9},"Negative":{"Guest":47,"Regular":54,"GuestPct":46.5,"RegularPct":53.5}},
                "File Management": {"Positive":{"Guest":16,"Regular":14,"GuestPct":53.3,"RegularPct":46.7},"Negative":{"Guest":38,"Regular":53,"GuestPct":41.8,"RegularPct":58.2}},
                "Performance & Speed": {"Positive":{"Guest":2,"Regular":6,"GuestPct":25,"RegularPct":75},"Negative":{"Guest":9,"Regular":59,"GuestPct":13.2,"RegularPct":86.8}},
                "Login & Access": {"Positive":{"Guest":1,"Regular":6,"GuestPct":14.3,"RegularPct":85.7},"Negative":{"Guest":19,"Regular":66,"GuestPct":22.4,"RegularPct":77.6}},
                "System Stability": {"Positive":{"Guest":1,"Regular":4,"GuestPct":20,"RegularPct":80},"Negative":{"Guest":3,"Regular":46,"GuestPct":6.1,"RegularPct":93.9}},
                "Visual & Accessibility": {"Positive":{"Guest":0,"Regular":5,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":11,"Regular":25,"GuestPct":30.6,"RegularPct":69.4}},
                "Collaboration": {"Positive":{"Guest":4,"Regular":6,"GuestPct":40,"RegularPct":60},"Negative":{"Guest":25,"Regular":11,"GuestPct":69.4,"RegularPct":30.6}},
                "Search": {"Positive":{"Guest":0,"Regular":9,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":0,"Regular":16,"GuestPct":0,"RegularPct":100}},
                "Metadata and Smart Extract": {"Positive":{"Guest":0,"Regular":2,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":6,"Regular":16,"GuestPct":27.3,"RegularPct":72.7}},
                "Automations and Workflows": {"Positive":{"Guest":0,"Regular":1,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":2,"Regular":12,"GuestPct":14.3,"RegularPct":85.7}},
                "Integrations": {"Positive":{"Guest":0,"Regular":1,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":1,"Regular":8,"GuestPct":11.1,"RegularPct":88.9}},
                "Mobile and Responsiveness": {"Positive":{"Guest":0,"Regular":1,"GuestPct":0,"RegularPct":100},"Negative":{"Guest":5,"Regular":3,"GuestPct":62.5,"RegularPct":37.5}}
            },
            // NEW: Monthly top categories by user type for hover
            monthlyTopCategories: {
                "2025-01": {"Guest":{"topPosSpecific":"File Management","topPosCount":2,"topNegSpecific":"Collaboration","topNegCount":6},"Regular":{"topPosSpecific":"File Management","topPosCount":3,"topNegSpecific":"Dislike New Experience","topNegCount":30}},
                "2025-02": {"Guest":{"topPosSpecific":"N/A","topPosCount":0,"topNegSpecific":"Document Functions","topNegCount":1},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":3,"topNegSpecific":"Login & Access","topNegCount":12}},
                "2025-03": {"Guest":{"topPosSpecific":"File Management","topPosCount":11,"topNegSpecific":"File Management","topNegCount":18},"Regular":{"topPosSpecific":"File Management","topPosCount":3,"topNegSpecific":"Dislike New Experience","topNegCount":26}},
                "2025-04": {"Guest":{"topPosSpecific":"User Interface & Navigation","topPosCount":3,"topNegSpecific":"User Interface & Navigation","topNegCount":8},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":4,"topNegSpecific":"Dislike New Experience","topNegCount":6}},
                "2025-05": {"Guest":{"topPosSpecific":"N/A","topPosCount":0,"topNegSpecific":"Visual & Accessibility","topNegCount":6},"Regular":{"topPosSpecific":"Dislike New Experience","topPosCount":5,"topNegSpecific":"Dislike New Experience","topNegCount":21}},
                "2025-06": {"Guest":{"topPosSpecific":"User Interface & Navigation","topPosCount":2,"topNegSpecific":"File Management","topNegCount":2},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":2,"topNegSpecific":"Dislike New Experience","topNegCount":24}},
                "2025-07": {"Guest":{"topPosSpecific":"N/A","topPosCount":0,"topNegSpecific":"User Interface & Navigation","topNegCount":2},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":2,"topNegSpecific":"Dislike New Experience","topNegCount":18}},
                "2025-08": {"Guest":{"topPosSpecific":"User Interface & Navigation","topPosCount":2,"topNegSpecific":"User Interface & Navigation","topNegCount":2},"Regular":{"topPosSpecific":"File Management","topPosCount":2,"topNegSpecific":"Performance & Speed","topNegCount":8}},
                "2025-09": {"Guest":{"topPosSpecific":"N/A","topPosCount":0,"topNegSpecific":"Collaboration","topNegCount":3},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":3,"topNegSpecific":"Login & Access","topNegCount":5}},
                "2025-10": {"Guest":{"topPosSpecific":"User Interface & Navigation","topPosCount":2,"topNegSpecific":"User Interface & Navigation","topNegCount":7},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":5,"topNegSpecific":"Document Functions","topNegCount":36}},
                "2025-11": {"Guest":{"topPosSpecific":"User Interface & Navigation","topPosCount":2,"topNegSpecific":"Collaboration","topNegCount":6},"Regular":{"topPosSpecific":"User Interface & Navigation","topPosCount":3,"topNegSpecific":"Document Functions","topNegCount":17}}
            },
            topPositiveDomains: [
                {domain:"kvc.org",rate:66.7,count:4,total:6},
                {domain:"ngroup.biz",rate:66.7,count:4,total:6},
                {domain:"benchmarkfs.org",rate:62.5,count:5,total:8},
                {domain:"icloud.com",rate:61.1,count:11,total:18},
                {domain:"msn.com",rate:50.0,count:7,total:14},
                {domain:"coatesfs.com",rate:50.0,count:3,total:6},
                {domain:"yahoo.com",rate:44.9,count:40,total:89},
                {domain:"outlook.com",rate:44.4,count:4,total:9},
                {domain:"sbcglobal.net",rate:42.9,count:6,total:14},
                {domain:"gmail.com",rate:42.0,count:180,total:429},
                {domain:"cityoffortmorgan.com",rate:40.0,count:2,total:5},
                {domain:"hotmail.com",rate:33.3,count:13,total:39},
                {domain:"gemd.com",rate:33.3,count:4,total:12},
                {domain:"ch.utah.gov",rate:33.3,count:2,total:6},
                {domain:"aol.com",rate:31.2,count:10,total:32}
            ],
            topNegativeDomains: [
                {domain:"khumbattapc.com",rate:100.0,count:18,total:18},
                {domain:"aboveallaccounting.com",rate:100.0,count:7,total:7},
                {domain:"unionsorters.com",rate:100.0,count:6,total:6},
                {domain:"mrs-co.com",rate:100.0,count:5,total:5},
                {domain:"vtncpas.com",rate:100.0,count:5,total:5},
                {domain:"gicpas.com",rate:100.0,count:5,total:5},
                {domain:"earnhardt.com",rate:100.0,count:5,total:5},
                {domain:"shannahanwell.com",rate:100.0,count:5,total:5},
                {domain:"storenfinancial.com",rate:91.0,count:121,total:133},
                {domain:"ballardcpa.com",rate:88.9,count:8,total:9},
                {domain:"verizon.net",rate:83.3,count:5,total:6},
                {domain:"birdiecpa.com",rate:83.3,count:5,total:6},
                {domain:"mizickmiller.com",rate:80.0,count:4,total:5},
                {domain:"prldocs.com",rate:80.0,count:4,total:5},
                {domain:"eccm.org",rate:80.0,count:4,total:5}
            ],
            // NEW: In-App vs Tech Services comparison (Regular users, Jun-Oct 2025)
            sourceComparison: {
                categories: [
                    "Account Management and Settings",
                    "Automations and Workflows",
                    "Document Functions",
                    "Emails, Notifications and Alerts",
                    "File Management",
                    "Integrations",
                    "Login and Access",
                    "Metadata and Smart Extract",
                    "Search"
                ],
                inAppRegular: [1, 11, 76, 6, 41, 4, 32, 14, 14],
                techServices: [268, 45, 121, 52, 84, 483, 95, 17, 32]
            },
            // NEW: VoC (Voice of Customer) data - Jan-Oct 2025
            vocData: {
                monthly: {
                    "2025-01": {"Metadata and Smart Extract":1,"Automations and Workflows":0,"Collaboration":3,"Document Functions":1,"Account Management and Settings":1,"File Management":0,"User Interface & Navigation":1,"Search":1,"Email, Notifications and Alerts":0,"Login & Access":0,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":1,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-02": {"Metadata and Smart Extract":1,"Automations and Workflows":4,"Collaboration":5,"Document Functions":0,"Account Management and Settings":0,"File Management":0,"User Interface & Navigation":0,"Search":0,"Email, Notifications and Alerts":0,"Login & Access":0,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-03": {"Metadata and Smart Extract":1,"Automations and Workflows":3,"Collaboration":2,"Document Functions":0,"Account Management and Settings":0,"File Management":0,"User Interface & Navigation":1,"Search":0,"Email, Notifications and Alerts":1,"Login & Access":1,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-04": {"Metadata and Smart Extract":2,"Automations and Workflows":4,"Collaboration":1,"Document Functions":2,"Account Management and Settings":1,"File Management":1,"User Interface & Navigation":0,"Search":0,"Email, Notifications and Alerts":0,"Login & Access":0,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-05": {"Metadata and Smart Extract":3,"Automations and Workflows":3,"Collaboration":5,"Document Functions":3,"Account Management and Settings":2,"File Management":2,"User Interface & Navigation":0,"Search":1,"Email, Notifications and Alerts":1,"Login & Access":0,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-06": {"Metadata and Smart Extract":6,"Automations and Workflows":3,"Collaboration":2,"Document Functions":1,"Account Management and Settings":2,"File Management":2,"User Interface & Navigation":1,"Search":1,"Email, Notifications and Alerts":1,"Login & Access":2,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-07": {"Metadata and Smart Extract":14,"Automations and Workflows":6,"Collaboration":2,"Document Functions":3,"Account Management and Settings":4,"File Management":9,"User Interface & Navigation":5,"Search":2,"Email, Notifications and Alerts":1,"Login & Access":0,"Performance & Speed":2,"Mobile and Responsiveness":1,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-08": {"Metadata and Smart Extract":0,"Automations and Workflows":1,"Collaboration":1,"Document Functions":1,"Account Management and Settings":3,"File Management":0,"User Interface & Navigation":0,"Search":0,"Email, Notifications and Alerts":0,"Login & Access":0,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":0,"Integrations":1,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-09": {"Metadata and Smart Extract":3,"Automations and Workflows":4,"Collaboration":0,"Document Functions":2,"Account Management and Settings":2,"File Management":0,"User Interface & Navigation":0,"Search":2,"Email, Notifications and Alerts":0,"Login & Access":0,"Performance & Speed":1,"Mobile and Responsiveness":1,"System Stability":0,"Integrations":0,"Dislike New Experience":0,"Visual & Accessibility":0},
                    "2025-10": {"Metadata and Smart Extract":6,"Automations and Workflows":3,"Collaboration":4,"Document Functions":6,"Account Management and Settings":2,"File Management":1,"User Interface & Navigation":0,"Search":1,"Email, Notifications and Alerts":1,"Login & Access":0,"Performance & Speed":0,"Mobile and Responsiveness":0,"System Stability":1,"Integrations":0,"Dislike New Experience":1,"Visual & Accessibility":0}
                },
                yearly: {
                    "Metadata and Smart Extract": 37,
                    "Automations and Workflows": 31,
                    "Collaboration": 25,
                    "Document Functions": 19,
                    "Account Management and Settings": 17,
                    "File Management": 15,
                    "User Interface & Navigation": 8,
                    "Search": 8,
                    "Email, Notifications and Alerts": 5,
                    "Login & Access": 3,
                    "Performance & Speed": 3,
                    "Mobile and Responsiveness": 2,
                    "System Stability": 2,
                    "Integrations": 1,
                    "Dislike New Experience": 1,
                    "Visual & Accessibility": 0
                },
                monthlyTotals: [8, 10, 8, 11, 20, 18, 44, 6, 15, 25]
            },
            // In-App yearly totals (excluding Sentiment Only for comparison)
            inAppYearly: {
                "Dislike New Experience": 206,
                "Document Functions": 168,
                "User Interface & Navigation": 163,
                "File Management": 156,
                "Performance & Speed": 115,
                "Login & Access": 100,
                "System Stability": 84,
                "Visual & Accessibility": 60,
                "Collaboration": 56,
                "Search": 40,
                "Metadata and Smart Extract": 24,
                "Automations and Workflows": 20,
                "Email, Notifications and Alerts": 12,
                "Integrations": 10,
                "Mobile and Responsiveness": 10,
                "Account Management and Settings": 6
            },
            // Tech Services yearly (Jun-Oct)
            techServicesYearly: {
                "Integrations": 483,
                "Account Management and Settings": 268,
                "Document Functions": 121,
                "Login & Access": 95,
                "File Management": 84,
                "Email, Notifications and Alerts": 52,
                "Automations and Workflows": 45,
                "Search": 32,
                "Metadata and Smart Extract": 17
            }
        };

        // ============= CHART INSTANCES =============
        let categoryChart, sentimentChart, userTypeChart, systemChart, categorySentimentChart, enhancedTrendChart, sourceComparisonChart, vocVsInAppChart, vocMonthlyChart, vocHeatmapChart;

        // ============= INITIALIZATION =============
        function initCharts() {
            // 1. NEW: Category by Sentiment Stacked Bar Chart
            const catSentCtx = document.getElementById('categorySentimentChart').getContext('2d');
            const sortedCats = Object.entries(dashboardData.categorySentiment)
                .sort((a, b) => b[1].Total - a[1].Total)
                .slice(0, 15);
            
            categorySentimentChart = new Chart(catSentCtx, {
                type: 'bar',
                data: {
                    labels: sortedCats.map(c => c[0]),
                    datasets: [
                        {
                            label: 'Positive',
                            data: sortedCats.map(c => c[1].Positive),
                            backgroundColor: '#48BB78'
                        },
                        {
                            label: 'Negative',
                            data: sortedCats.map(c => c[1].Negative),
                            backgroundColor: '#F56565'
                        },
                        {
                            label: 'Neutral',
                            data: sortedCats.map(c => c[1].Neutral),
                            backgroundColor: '#ECC94B'
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                afterBody: function(context) {
                                    const cat = context[0].label;
                                    const data = dashboardData.categorySentiment[cat];
                                    const total = data.Total;
                                    return `\nTotal: ${total}\nPositive: ${Math.round(data.Positive/total*100)}%\nNegative: ${Math.round(data.Negative/total*100)}%\nNeutral: ${Math.round(data.Neutral/total*100)}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A0AEC0' }
                        },
                        y: {
                            stacked: true,
                            grid: { display: false },
                            ticks: { color: '#F7FAFC', font: { size: 11 } }
                        }
                    }
                }
            });

            // 2. NEW: Enhanced Trend Chart with custom tooltip
            const enhTrendCtx = document.getElementById('enhancedTrendChart').getContext('2d');
            enhancedTrendChart = new Chart(enhTrendCtx, {
                type: 'line',
                data: {
                    labels: dashboardData.monthLabels,
                    datasets: [
                        {
                            label: 'Positive',
                            data: dashboardData.months.map(m => dashboardData.monthly[m]?.sentiment?.Positive || 0),
                            borderColor: '#48BB78',
                            backgroundColor: 'rgba(72, 187, 120, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointHoverRadius: 10
                        },
                        {
                            label: 'Negative',
                            data: dashboardData.months.map(m => dashboardData.monthly[m]?.sentiment?.Negative || 0),
                            borderColor: '#F56565',
                            backgroundColor: 'rgba(245, 101, 101, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointHoverRadius: 10
                        },
                        {
                            label: 'Neutral',
                            data: dashboardData.months.map(m => dashboardData.monthly[m]?.sentiment?.Neutral || 0),
                            borderColor: '#ECC94B',
                            backgroundColor: 'rgba(236, 201, 75, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointHoverRadius: 10
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#A0AEC0', padding: 20, font: { size: 12 } }
                        },
                        tooltip: {
                            backgroundColor: '#242938',
                            titleColor: '#F7FAFC',
                            bodyColor: '#A0AEC0',
                            borderColor: '#3D4663',
                            borderWidth: 1,
                            padding: 16,
                            displayColors: true,
                            callbacks: {
                                afterBody: function(context) {
                                    const monthIndex = context[0].dataIndex;
                                    const monthKey = dashboardData.months[monthIndex];
                                    const topCats = dashboardData.monthlyTopCategories[monthKey];
                                    
                                    if (!topCats) return '';
                                    
                                    let lines = ['\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ'];
                                    lines.push('üìä Top Categories (excl. Sentiment Only):');
                                    lines.push('');
                                    lines.push('üë§ GUESTS:');
                                    lines.push(`   ‚úì Positive: ${topCats.Guest.topPosSpecific} (${topCats.Guest.topPosCount})`);
                                    lines.push(`   ‚úó Negative: ${topCats.Guest.topNegSpecific} (${topCats.Guest.topNegCount})`);
                                    lines.push('');
                                    lines.push('üëî REGULAR USERS:');
                                    lines.push(`   ‚úì Positive: ${topCats.Regular.topPosSpecific} (${topCats.Regular.topPosCount})`);
                                    lines.push(`   ‚úó Negative: ${topCats.Regular.topNegSpecific} (${topCats.Regular.topNegCount})`);
                                    
                                    return lines.join('\n');
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A0AEC0' }
                        },
                        y: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A0AEC0' }
                        }
                    }
                }
            });

            // 3. NEW: Source Comparison Chart (In-App vs Tech Services)
            const sourceCompCtx = document.getElementById('sourceComparisonChart').getContext('2d');
            sourceComparisonChart = new Chart(sourceCompCtx, {
                type: 'bar',
                data: {
                    labels: dashboardData.sourceComparison.categories,
                    datasets: [
                        {
                            label: 'In-App Feedback',
                            data: dashboardData.sourceComparison.inAppRegular,
                            backgroundColor: '#6B46C1',
                            borderRadius: 4
                        },
                        {
                            label: 'Tech Services',
                            data: dashboardData.sourceComparison.techServices,
                            backgroundColor: '#ED8936',
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#242938',
                            titleColor: '#F7FAFC',
                            bodyColor: '#A0AEC0',
                            borderColor: '#3D4663',
                            borderWidth: 1,
                            padding: 12,
                            callbacks: {
                                afterBody: function(context) {
                                    const idx = context[0].dataIndex;
                                    const inApp = dashboardData.sourceComparison.inAppRegular[idx];
                                    const tech = dashboardData.sourceComparison.techServices[idx];
                                    const total = inApp + tech;
                                    const inAppPct = Math.round(inApp / total * 100);
                                    const techPct = Math.round(tech / total * 100);
                                    return `\nIn-App: ${inAppPct}% | Tech Services: ${techPct}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { color: '#A0AEC0' }
                        },
                        y: {
                            grid: { display: false },
                            ticks: { color: '#F7FAFC', font: { size: 11 } }
                        }
                    }
                }
            });

            // 3b. VoC vs In-App Comparison Chart
            const vocVsInAppCtx = document.getElementById('vocVsInAppChart').getContext('2d');
            const vocYearly = dashboardData.vocData.yearly;
            const inAppYearly = dashboardData.inAppYearly;
            
            // Get top 10 categories by combined volume
            const allCats = [...new Set([...Object.keys(vocYearly), ...Object.keys(inAppYearly)])];
            const combinedData = allCats.map(cat => ({
                name: cat,
                voc: vocYearly[cat] || 0,
                inApp: inAppYearly[cat] || 0,
                total: (vocYearly[cat] || 0) + (inAppYearly[cat] || 0)
            })).sort((a, b) => b.total - a.total).slice(0, 10);
            
            vocVsInAppChart = new Chart(vocVsInAppCtx, {
                type: 'bar',
                data: {
                    labels: combinedData.map(d => d.name),
                    datasets: [
                        {
                            label: 'VoC Meetings',
                            data: combinedData.map(d => d.voc),
                            backgroundColor: '#9F7AEA',
                            borderRadius: 4
                        },
                        {
                            label: 'In-App Feedback',
                            data: combinedData.map(d => d.inApp),
                            backgroundColor: '#6B46C1',
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#A0AEC0' } },
                        y: { grid: { display: false }, ticks: { color: '#F7FAFC', font: { size: 10 } } }
                    }
                }
            });

            // 3c. VoC Monthly Volume Trend
            const vocMonthlyCtx = document.getElementById('vocMonthlyChart').getContext('2d');
            vocMonthlyChart = new Chart(vocMonthlyCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                    datasets: [{
                        label: 'VoC Issues',
                        data: dashboardData.vocData.monthlyTotals,
                        borderColor: '#9F7AEA',
                        backgroundColor: 'rgba(159, 122, 234, 0.2)',
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointBackgroundColor: '#9F7AEA',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointHoverRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#242938',
                            titleColor: '#F7FAFC',
                            bodyColor: '#A0AEC0',
                            callbacks: {
                                afterBody: function(context) {
                                    const monthIdx = context[0].dataIndex;
                                    const monthKeys = ['2025-01','2025-02','2025-03','2025-04','2025-05','2025-06','2025-07','2025-08','2025-09','2025-10'];
                                    const monthData = dashboardData.vocData.monthly[monthKeys[monthIdx]];
                                    if (!monthData) return '';
                                    
                                    // Get top 3 categories for this month
                                    const sorted = Object.entries(monthData)
                                        .filter(([k, v]) => v > 0)
                                        .sort((a, b) => b[1] - a[1])
                                        .slice(0, 3);
                                    
                                    if (sorted.length === 0) return '\nNo specific themes';
                                    
                                    let lines = ['\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', 'Top themes:'];
                                    sorted.forEach(([cat, count]) => {
                                        lines.push(`‚Ä¢ ${cat}: ${count}`);
                                    });
                                    return lines.join('\n');
                                }
                            }
                        }
                    },
                    scales: {
                        x: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#A0AEC0' } },
                        y: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#A0AEC0' }, beginAtZero: true }
                    }
                }
            });

            // 3d. VoC Category Heatmap-style Chart (stacked bar by month)
            const vocHeatmapCtx = document.getElementById('vocHeatmapChart').getContext('2d');
            const vocMonthKeys = ['2025-01','2025-02','2025-03','2025-04','2025-05','2025-06','2025-07','2025-08','2025-09','2025-10'];
            const vocMonthLabels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'];
            
            // Get top 8 VoC categories
            const topVocCats = Object.entries(dashboardData.vocData.yearly)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8)
                .map(c => c[0]);
            
            const vocColors = ['#9F7AEA', '#6B46C1', '#319795', '#38A169', '#ED8936', '#E53E3E', '#3182CE', '#D69E2E'];
            
            vocHeatmapChart = new Chart(vocHeatmapCtx, {
                type: 'bar',
                data: {
                    labels: vocMonthLabels,
                    datasets: topVocCats.map((cat, i) => ({
                        label: cat,
                        data: vocMonthKeys.map(mk => dashboardData.vocData.monthly[mk]?.[cat] || 0),
                        backgroundColor: vocColors[i],
                        borderRadius: 2
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#A0AEC0', padding: 15, font: { size: 11 }, boxWidth: 12 }
                        }
                    },
                    scales: {
                        x: { stacked: true, grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#A0AEC0' } },
                        y: { stacked: true, grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#A0AEC0' } }
                    }
                }
            });

            // 4. Original Category Chart
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            categoryChart = new Chart(categoryCtx, {
                type: 'bar',
                data: { labels: [], datasets: [{ data: [], backgroundColor: '#6B46C1' }] },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#A0AEC0' } },
                        y: { grid: { display: false }, ticks: { color: '#F7FAFC', font: { size: 11 } } }
                    }
                }
            });

            // 5. Sentiment Chart
            const sentimentCtx = document.getElementById('sentimentChart').getContext('2d');
            sentimentChart = new Chart(sentimentCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Positive', 'Negative', 'Neutral'],
                    datasets: [{ data: [], backgroundColor: ['#48BB78', '#F56565', '#ECC94B'], borderWidth: 0 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: { legend: { position: 'bottom', labels: { color: '#A0AEC0', padding: 20, font: { size: 12 } } } }
                }
            });

            // 6. User Type Chart
            const userTypeCtx = document.getElementById('userTypeChart').getContext('2d');
            userTypeChart = new Chart(userTypeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Regular', 'Guest'],
                    datasets: [{ data: [], backgroundColor: ['#6B46C1', '#319795'], borderWidth: 0 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: { legend: { position: 'bottom', labels: { color: '#A0AEC0', padding: 20, font: { size: 12 } } } }
                }
            });

            // 7. System Chart
            const systemCtx = document.getElementById('systemChart').getContext('2d');
            systemChart = new Chart(systemCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Browser', 'Desktop'],
                    datasets: [{ data: [], backgroundColor: ['#3182CE', '#ED8936'], borderWidth: 0 }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: { legend: { position: 'bottom', labels: { color: '#A0AEC0', padding: 20, font: { size: 12 } } } }
                }
            });
        }

        // ============= BUILD BREAKDOWN TABLE =============
        function buildBreakdownTable() {
            const tbody = document.getElementById('breakdownTableBody');
            const sortedCats = Object.entries(dashboardData.categorySentiment)
                .sort((a, b) => b[1].Total - a[1].Total);
            
            tbody.innerHTML = sortedCats.map(([cat, data]) => {
                const ut = dashboardData.categorySentimentUserType[cat];
                if (!ut) return '';
                
                const posGuestPct = ut.Positive.GuestPct || 0;
                const posRegPct = ut.Positive.RegularPct || 0;
                const negGuestPct = ut.Negative.GuestPct || 0;
                const negRegPct = ut.Negative.RegularPct || 0;
                
                return `
                    <tr>
                        <td class="cat-name">${cat}</td>
                        <td class="num pct-positive">${data.Positive}</td>
                        <td>
                            <div class="user-bar">
                                <div class="user-bar-guest" style="width: ${posGuestPct}%" title="Guest: ${posGuestPct}%"></div>
                                <div class="user-bar-regular" style="width: ${posRegPct}%" title="Regular: ${posRegPct}%"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 10px; color: var(--text-muted); margin-top: 4px;">
                                <span>G: ${posGuestPct}%</span>
                                <span>R: ${posRegPct}%</span>
                            </div>
                        </td>
                        <td class="num pct-negative">${data.Negative}</td>
                        <td>
                            <div class="user-bar">
                                <div class="user-bar-guest" style="width: ${negGuestPct}%" title="Guest: ${negGuestPct}%"></div>
                                <div class="user-bar-regular" style="width: ${negRegPct}%" title="Regular: ${negRegPct}%"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 10px; color: var(--text-muted); margin-top: 4px;">
                                <span>G: ${negGuestPct}%</span>
                                <span>R: ${negRegPct}%</span>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ============= UPDATE DASHBOARD =============
        function updateDashboard(period) {
            const data = period === 'yearly' ? dashboardData.yearly : dashboardData.monthly[period];
            if (!data) return;

            const totalFeedback = Object.values(data.categories).reduce((a, b) => a + b, 0);
            const positiveRate = Math.round((data.sentiment.Positive / totalFeedback) * 100);
            const guestCount = data.userType.Guest || 0;
            const guestPercent = Math.round((guestCount / totalFeedback) * 100);
            const browserCount = data.system.Browser || 0;
            const browserPercent = Math.round((browserCount / totalFeedback) * 100);

            document.getElementById('totalFeedback').textContent = totalFeedback.toLocaleString();
            document.getElementById('feedbackDetail').textContent = period === 'yearly' ? 'Jan - Nov 2025' : 'Selected month';
            document.getElementById('sentimentScore').textContent = positiveRate + '%';
            document.getElementById('sentimentDetail').textContent = `${data.sentiment.Positive.toLocaleString()} positive of ${totalFeedback.toLocaleString()}`;
            document.getElementById('guestPercent').textContent = guestPercent + '%';
            document.getElementById('guestDetail').textContent = `${guestCount.toLocaleString()} of ${totalFeedback.toLocaleString()} responses`;
            document.getElementById('browserPercent').textContent = browserPercent + '%';
            document.getElementById('browserDetail').textContent = `${browserCount.toLocaleString()} browser users`;

            const sortedCategories = Object.entries(data.categories).sort((a, b) => b[1] - a[1]).slice(0, 15);
            categoryChart.data.labels = sortedCategories.map(c => c[0]);
            categoryChart.data.datasets[0].data = sortedCategories.map(c => c[1]);
            categoryChart.update();

            sentimentChart.data.datasets[0].data = [data.sentiment.Positive || 0, data.sentiment.Negative || 0, data.sentiment.Neutral || 0];
            sentimentChart.update();

            userTypeChart.data.datasets[0].data = [data.userType.Regular || 0, data.userType.Guest || 0];
            userTypeChart.update();

            systemChart.data.datasets[0].data = [data.system.Browser || 0, data.system.Desktop || 0];
            systemChart.update();

            updateCategoryComparison('guestCategories', data.guestTop5, 'fill-guest');
            updateCategoryComparison('regularCategories', data.regularTop5, 'fill-regular');
        }

        function updateCategoryComparison(elementId, categoryData, fillClass) {
            const container = document.getElementById(elementId);
            const entries = Object.entries(categoryData);
            const maxValue = Math.max(...entries.map(e => e[1]));
            
            container.innerHTML = entries.map(([name, count], index) => {
                const percentage = (count / maxValue) * 100;
                return `
                    <div class="category-item">
                        <div class="category-rank">${index + 1}</div>
                        <div class="category-bar-container">
                            <div class="category-name">${name}</div>
                            <div class="category-bar">
                                <div class="category-bar-fill ${fillClass}" style="width: ${percentage}%"></div>
                            </div>
                        </div>
                        <div class="category-count">${count}</div>
                    </div>
                `;
            }).join('');
        }

        function renderDomainLists() {
            document.getElementById('positiveDomains').innerHTML = dashboardData.topPositiveDomains.map(d => `
                <div class="domain-item">
                    <div class="domain-name">${d.domain}</div>
                    <div class="domain-rate rate-positive">${d.rate}%</div>
                    <div class="domain-count">${d.count}/${d.total}</div>
                </div>
            `).join('');

            document.getElementById('negativeDomains').innerHTML = dashboardData.topNegativeDomains.map(d => `
                <div class="domain-item">
                    <div class="domain-name">${d.domain}</div>
                    <div class="domain-rate rate-negative">${d.rate}%</div>
                    <div class="domain-count">${d.count}/${d.total}</div>
                </div>
            `).join('');
        }

        // NEW: Render Most Liked / Most Complained Features
        function renderFeatureRankings() {
            // Get positive counts excluding "Sentiment Only"
            const positiveCats = Object.entries(dashboardData.categorySentiment)
                .filter(([cat, data]) => cat !== 'Sentiment Only' && data.Positive > 0)
                .map(([cat, data]) => ({ name: cat, count: data.Positive, total: data.Total }))
                .sort((a, b) => b.count - a.count)
                .slice(0, 5);
            
            // Get negative counts excluding "Sentiment Only"
            const negativeCats = Object.entries(dashboardData.categorySentiment)
                .filter(([cat, data]) => cat !== 'Sentiment Only' && data.Negative > 0)
                .map(([cat, data]) => ({ name: cat, count: data.Negative, total: data.Total }))
                .sort((a, b) => b.count - a.count)
                .slice(0, 5);
            
            const maxPositive = positiveCats[0]?.count || 1;
            const maxNegative = negativeCats[0]?.count || 1;
            
            document.getElementById('mostLikedFeatures').innerHTML = positiveCats.map((item, i) => `
                <div class="feature-item">
                    <div class="feature-rank rank-positive">${i + 1}</div>
                    <div class="feature-info">
                        <div class="feature-name">${item.name}</div>
                        <div class="feature-bar">
                            <div class="feature-bar-fill-positive" style="width: ${(item.count / maxPositive) * 100}%"></div>
                        </div>
                        <div class="feature-stats">${Math.round(item.count / item.total * 100)}% of this category's feedback is positive</div>
                    </div>
                    <div class="feature-count count-positive">${item.count}</div>
                </div>
            `).join('');
            
            document.getElementById('mostComplainedFeatures').innerHTML = negativeCats.map((item, i) => `
                <div class="feature-item">
                    <div class="feature-rank rank-negative">${i + 1}</div>
                    <div class="feature-info">
                        <div class="feature-name">${item.name}</div>
                        <div class="feature-bar">
                            <div class="feature-bar-fill-negative" style="width: ${(item.count / maxNegative) * 100}%"></div>
                        </div>
                        <div class="feature-stats">${Math.round(item.count / item.total * 100)}% of this category's feedback is negative</div>
                    </div>
                    <div class="feature-count count-negative">${item.count}</div>
                </div>
            `).join('');
        }

        // NEW: Render Three-Source Ranking Comparison
        function renderThreeSourceRanking() {
            const container = document.getElementById('threeSourceRanking');
            
            // Prepare data for each source
            const inAppRanked = Object.entries(dashboardData.inAppYearly)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8);
            
            const techServicesRanked = Object.entries(dashboardData.techServicesYearly)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8);
            
            const vocRanked = Object.entries(dashboardData.vocData.yearly)
                .filter(([k, v]) => v > 0)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8);
            
            function renderColumn(title, subtitle, icon, iconBg, data) {
                const items = data.map(([name, count], i) => {
                    const posClass = i === 0 ? 'pos-1' : i === 1 ? 'pos-2' : i === 2 ? 'pos-3' : 'pos-other';
                    return `
                        <div class="ranking-item">
                            <div class="ranking-position ${posClass}">${i + 1}</div>
                            <div class="ranking-name" title="${name}">${name}</div>
                            <div class="ranking-count">${count}</div>
                        </div>
                    `;
                }).join('');
                
                return `
                    <div class="ranking-column">
                        <div class="ranking-column-header">
                            <div class="ranking-column-icon" style="background: ${iconBg};">${icon}</div>
                            <div>
                                <div class="ranking-column-title">${title}</div>
                                <div class="ranking-column-subtitle">${subtitle}</div>
                            </div>
                        </div>
                        <div class="ranking-list">${items}</div>
                    </div>
                `;
            }
            
            container.innerHTML = 
                renderColumn('In-App Feedback', '1,232 issues (excl. Sentiment Only)', 'üí¨', 'rgba(107, 70, 193, 0.2)', inAppRanked) +
                renderColumn('Tech Services', '1,197 tickets (Jun-Oct)', 'üéß', 'rgba(237, 137, 54, 0.2)', techServicesRanked) +
                renderColumn('VoC Meetings', '177 themes (Jan-Oct)', 'üé§', 'rgba(159, 122, 234, 0.2)', vocRanked);
        }
        
        // NEW: Render Commonalities and Gaps
        function renderCommonalitiesAndGaps() {
            const inApp = dashboardData.inAppYearly;
            const tech = dashboardData.techServicesYearly;
            const voc = dashboardData.vocData.yearly;
            
            const inAppTotal = Object.values(inApp).reduce((a, b) => a + b, 0);
            const techTotal = Object.values(tech).reduce((a, b) => a + b, 0);
            const vocTotal = Object.values(voc).reduce((a, b) => a + b, 0);
            
            // Commonalities data
            const commonalities = [
                {
                    name: 'Document Functions',
                    icon: 'üìÑ',
                    inApp: inApp['Document Functions'] || 0,
                    tech: tech['Document Functions'] || 0,
                    voc: voc['Document Functions'] || 0,
                    note: 'Universal pain point ‚Äî preview, print, viewing issues affect everyone'
                },
                {
                    name: 'File Management',
                    icon: 'üìÅ',
                    inApp: inApp['File Management'] || 0,
                    tech: tech['File Management'] || 0,
                    voc: voc['File Management'] || 0,
                    note: 'Upload/download problems consistently reported across all channels'
                },
                {
                    name: 'Search',
                    icon: 'üîç',
                    inApp: inApp['Search'] || 0,
                    tech: tech['Search'] || 0,
                    voc: voc['Search'] || 0,
                    note: 'Moderate but consistent ‚Äî users struggle to find documents'
                }
            ];
            
            // Gaps data
            const gaps = [
                {
                    name: 'Integrations',
                    icon: 'üîå',
                    dominant: 'Tech Services',
                    inApp: inApp['Integrations'] || 0,
                    tech: tech['Integrations'] || 0,
                    voc: voc['Integrations'] || 0,
                    note: '40% of Tech Services vs <1% In-App ‚Äî users call support, don\'t submit feedback'
                },
                {
                    name: 'Dislike New Experience',
                    icon: 'üò§',
                    dominant: 'In-App',
                    inApp: inApp['Dislike New Experience'] || 0,
                    tech: 0,
                    voc: voc['Dislike New Experience'] || 0,
                    note: 'Reactive frustration only captured via feedback widget ‚Äî invisible elsewhere'
                },
                {
                    name: 'Metadata & Smart Extract',
                    icon: 'ü§ñ',
                    dominant: 'VoC',
                    inApp: inApp['Metadata and Smart Extract'] || 0,
                    tech: tech['Metadata and Smart Extract'] || 0,
                    voc: voc['Metadata and Smart Extract'] || 0,
                    note: 'Complex enterprise feature needs discussion ‚Äî can\'t explain in feedback box'
                },
                {
                    name: 'Account Management',
                    icon: '‚öôÔ∏è',
                    dominant: 'Tech Services',
                    inApp: inApp['Account Management and Settings'] || 0,
                    tech: tech['Account Management and Settings'] || 0,
                    voc: voc['Account Management and Settings'] || 0,
                    note: '22% of Tech Services ‚Äî setup issues require support, not feedback'
                }
            ];
            
            function getBarWidth(value, total, maxPct = 50) {
                const pct = (value / total) * 100;
                return Math.min((pct / maxPct) * 100, 100);
            }
            
            // Render commonalities
            document.getElementById('commonalitiesList').innerHTML = commonalities.map(item => `
                <div class="insight-item">
                    <div class="insight-header">
                        <span class="insight-icon">${item.icon}</span>
                        <span class="insight-title">${item.name}</span>
                    </div>
                    <div class="insight-bars">
                        <div class="insight-bar-group">
                            <div class="insight-bar-label"><span>In-App</span><span>${item.inApp}</span></div>
                            <div class="insight-bar"><div class="insight-bar-fill fill-inapp" style="width: ${getBarWidth(item.inApp, inAppTotal)}%"></div></div>
                        </div>
                        <div class="insight-bar-group">
                            <div class="insight-bar-label"><span>Tech Svc</span><span>${item.tech}</span></div>
                            <div class="insight-bar"><div class="insight-bar-fill fill-tech" style="width: ${getBarWidth(item.tech, techTotal)}%"></div></div>
                        </div>
                        <div class="insight-bar-group">
                            <div class="insight-bar-label"><span>VoC</span><span>${item.voc}</span></div>
                            <div class="insight-bar"><div class="insight-bar-fill fill-voc" style="width: ${getBarWidth(item.voc, vocTotal)}%"></div></div>
                        </div>
                    </div>
                    <div class="insight-note">üí° ${item.note}</div>
                </div>
            `).join('');
            
            // Render gaps
            document.getElementById('gapsList').innerHTML = gaps.map(item => `
                <div class="insight-item">
                    <div class="insight-header">
                        <span class="insight-icon">${item.icon}</span>
                        <span class="insight-title">${item.name}</span>
                        <span style="margin-left: auto; font-size: 10px; background: var(--border-color); padding: 2px 8px; border-radius: 10px; color: var(--text-secondary);">${item.dominant} dominant</span>
                    </div>
                    <div class="insight-bars">
                        <div class="insight-bar-group">
                            <div class="insight-bar-label"><span>In-App</span><span>${item.inApp}</span></div>
                            <div class="insight-bar"><div class="insight-bar-fill fill-inapp" style="width: ${getBarWidth(item.inApp, inAppTotal)}%"></div></div>
                        </div>
                        <div class="insight-bar-group">
                            <div class="insight-bar-label"><span>Tech Svc</span><span>${item.tech}</span></div>
                            <div class="insight-bar"><div class="insight-bar-fill fill-tech" style="width: ${getBarWidth(item.tech, techTotal)}%"></div></div>
                        </div>
                        <div class="insight-bar-group">
                            <div class="insight-bar-label"><span>VoC</span><span>${item.voc}</span></div>
                            <div class="insight-bar"><div class="insight-bar-fill fill-voc" style="width: ${getBarWidth(item.voc, vocTotal)}%"></div></div>
                        </div>
                    </div>
                    <div class="insight-note">üö® ${item.note}</div>
                </div>
            `).join('');
        }
        
        // NEW: Render Coverage Heatmap
        function renderCoverageHeatmap() {
            const inApp = dashboardData.inAppYearly;
            const tech = dashboardData.techServicesYearly;
            const voc = dashboardData.vocData.yearly;
            
            const inAppTotal = Object.values(inApp).reduce((a, b) => a + b, 0);
            const techTotal = Object.values(tech).reduce((a, b) => a + b, 0);
            const vocTotal = Object.values(voc).reduce((a, b) => a + b, 0);
            
            // Get all categories and sort by total volume across sources
            const allCats = [...new Set([...Object.keys(inApp), ...Object.keys(tech), ...Object.keys(voc)])];
            const catData = allCats.map(cat => ({
                name: cat,
                inApp: inApp[cat] || 0,
                tech: tech[cat] || 0,
                voc: voc[cat] || 0,
                inAppPct: ((inApp[cat] || 0) / inAppTotal * 100),
                techPct: ((tech[cat] || 0) / techTotal * 100),
                vocPct: ((voc[cat] || 0) / vocTotal * 100),
                total: (inApp[cat] || 0) + (tech[cat] || 0) + (voc[cat] || 0)
            })).sort((a, b) => b.total - a.total);
            
            function getHeatColor(pct) {
                if (pct >= 30) return { bg: '#B794F4', text: '#1A1F2E' };
                if (pct >= 15) return { bg: '#805AD5', text: 'white' };
                if (pct >= 8) return { bg: '#6B46C1', text: 'white' };
                if (pct >= 3) return { bg: '#553C9A', text: 'white' };
                if (pct >= 1) return { bg: '#44337A', text: '#A0AEC0' };
                return { bg: '#2D3348', text: '#718096' };
            }
            
            const rows = catData.map(cat => {
                const inAppColor = getHeatColor(cat.inAppPct);
                const techColor = getHeatColor(cat.techPct);
                const vocColor = getHeatColor(cat.vocPct);
                
                return `
                    <tr>
                        <td class="cat-name">${cat.name}</td>
                        <td class="heatmap-cell" style="background: ${inAppColor.bg}; color: ${inAppColor.text};">${cat.inAppPct.toFixed(1)}%</td>
                        <td class="heatmap-cell" style="background: ${techColor.bg}; color: ${techColor.text};">${cat.techPct.toFixed(1)}%</td>
                        <td class="heatmap-cell" style="background: ${vocColor.bg}; color: ${vocColor.text};">${cat.vocPct.toFixed(1)}%</td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('coverageHeatmap').innerHTML = `
                <table class="heatmap-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th class="source-header">üí¨ In-App<br><span style="font-weight: 400; font-size: 10px;">(${inAppTotal} total)</span></th>
                            <th class="source-header">üéß Tech Services<br><span style="font-weight: 400; font-size: 10px;">(${techTotal} total)</span></th>
                            <th class="source-header">üé§ VoC<br><span style="font-weight: 400; font-size: 10px;">(${vocTotal} total)</span></th>
                        </tr>
                    </thead>
                    <tbody>${rows}</tbody>
                </table>
            `;
        }

        // ============= EVENT LISTENERS =============
        document.getElementById('monthSelect').addEventListener('change', function() {
            const period = this.value;
            updateDashboard(period);
            
            // Update period indicator in header
            const indicator = document.getElementById('periodIndicator');
            if (period === 'yearly') {
                indicator.textContent = 'Full Year 2025';
            } else {
                const monthNames = {
                    '2025-01': 'January 2025',
                    '2025-02': 'February 2025',
                    '2025-03': 'March 2025',
                    '2025-04': 'April 2025',
                    '2025-05': 'May 2025',
                    '2025-06': 'June 2025',
                    '2025-07': 'July 2025',
                    '2025-08': 'August 2025',
                    '2025-09': 'September 2025',
                    '2025-10': 'October 2025',
                    '2025-11': 'November 2025'
                };
                indicator.textContent = monthNames[period] || period;
            }
            
            // Add animation to indicator
            indicator.style.animation = 'none';
            indicator.offsetHeight; // Trigger reflow
            indicator.style.animation = 'fadeIn 0.3s ease';
        });

        // ============= INIT =============
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            buildBreakdownTable();
            renderFeatureRankings();
            renderThreeSourceRanking();
            renderCommonalitiesAndGaps();
            renderCoverageHeatmap();
            updateDashboard('yearly');
            renderDomainLists();
        });
    </script>
</body>
</html>
